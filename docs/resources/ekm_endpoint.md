---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ciphertrust_ekm_endpoint Resource - terraform-provider-ciphertrust"
subcategory: ""
description: |-
  
---

# ciphertrust_ekm_endpoint (Resource)

This resource establishes the connection between Google Externally Managed Keys and CipherTrust Manager.

This resource is dependent on a Google Project existing in CipherTrust Manager.

Projects can be added to CipherTrust Manager by creating either of the following resources: 
- [ciphertrust_gcp_connection](https://registry.terraform.io/providers/ThalesGroup/ciphertrust/latest/docs/resources/gcp_connection)
- [ciphertrust_google_project](https://registry.terraform.io/providers/ThalesGroup/ciphertrust/latest/docs/resources/google_project)

This resource is applicable to CipherTrust Manager and CipherTrust Data Security Platform as a Service(CDSPaaS).

## Example Usage

```terraform
# A Google Cloud (GCP) connection must exist to create EKM endpoints.

# Create an EKM endpoint with minimum parameters
resource "ciphertrust_ekm_endpoint" "ekm_endpoint" {
  depends_on = [
    ciphertrust_gcp_connection.connection,
  ]
  name             = "endpoint-name"
  key_uri_hostname = "terraform.example.com"
  policy {
    clients = ["abc@google.com"]
  }
}

# Create an EKM endpoint with an asymmetric key
resource "ciphertrust_ekm_endpoint" "ekm_endpoint" {
  depends_on = [
    ciphertrust_gcp_connection.connection,
  ]
  name             = "endpoint-name"
  key_uri_hostname = "terraform.example.com"
  meta             = "some information to store with endpoint"
  policy {
    clients                = ["abc@google.com", "efg@google.com"]
    justification_required = true
    justification_reason   = ["CUSTOMER_INITIATED_SUPPORT", "MODIFIED_CUSTOMER_INITIATED_ACCESS"]
  }
  key_type  = "asymmetric"
  algorithm = "EC_SIGN_P256_SHA256"
}

# Create a UDE EKM endpoint
resource "ciphertrust_ekm_endpoint" "ekm_endpoint" {
  depends_on = [
    ciphertrust_gcp_connection.connection,
  ]
  name                    = "endpoint-name"
  key_uri_hostname        = "terraform.example.com"
  cvm_required_for_unwrap = true
  cvm_required_for_wrap   = true
  endpoint_type           = "ekm-ude"
  meta                    = "some information to store with endpoint"
  policy {
    clients                    = ["abc@google.com", "efg@google.com"]
    justification_required     = true
    justification_reason       = ["CUSTOMER_INITIATED_SUPPORT", "MODIFIED_CUSTOMER_INITIATED_ACCESS"]
    attestation_zones          = ["zone-a", "zone-b"]
    attestation_project_ids    = ["project-a", "project-b"]
    attestation_instance_names = ["instance-a", "instance-b"]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `key_uri_hostname` (String) (Updateable) Base URL hostname for the key URI.
- `name` (String) Unique name for the endpoint.
- `policy` (Block Set, Min: 1, Max: 1) (Updateable) EKM endpoint policy. (see [below for nested schema](#nestedblock--policy))

### Optional

- `algorithm` (String) EKM key algorithm. Default is AES256 if key_type is symmetric otherwise it must be specified. Options: AES256, RSA_SIGN_PSS_2048_SHA256, RSA_SIGN_PSS_3072_SHA256, RSA_SIGN_PSS_4096_SHA256, RSA_SIGN_PSS_4096_SHA512, RSA_SIGN_PKCS1_2048_SHA256, RSA_SIGN_PKCS1_3072_SHA256, RSA_SIGN_PKCS1_4096_SHA256, RSA_SIGN_PKCS1_4096_SHA512, EC_SIGN_P256_SHA256 and EC_SIGN_P384_SHA384.
- `cvm_required_for_unwrap` (Boolean) (Updateable) Applicable to UDE endpoints only. Set to true if unwrap requests must originate from a confidential VM. Default is false.
- `cvm_required_for_wrap` (Boolean) (Updateable) Applicable to UDE endpoints only. Set to true if wrap requests must originate from a confidential VM. Default is false.
- `enabled` (Boolean) (Updateable) True by default.
- `endpoint_type` (String) EKM endpoint type. Options: ekm or ekm-ude. Default is ekm.
- `existing_key_id` (String) For migration from another CM deployment. ID of an existing key to use. If not supplied a new key will be created.
- `key_type` (String) EKM key type. Only symmetric keys are valid for UDE endpoints. Options: symmetric or asymmetric. Default is symmetric.
- `meta` (Map of String) (Updateable) A list of key:value pairs to store with the endpoint.

### Read-Only

- `id` (String) CipherTrust ID of the External Key Manager endpoint.
- `kek_id` (String) ID of the key encrypting key.
- `kek_name` (String) Name of the key encrypting key.
- `kek_version` (String) Version of the key encrypting key.
- `key_path` (String) Path of the key.
- `key_uri` (String) URL of the key.
- `raw_policy` (String) EKM policy in rego format.

<a id="nestedblock--policy"></a>
### Nested Schema for `policy`

Required:

- `clients` (Set of String) Allowed Service Accounts.

Optional:

- `attestation_instance_names` (Set of String) Allowed instance names. Applicable to UDE endpoints only.
- `attestation_project_ids` (Set of String) Allowed project IDs. Applicable to UDE endpoints only.
- `attestation_zones` (Set of String) Allowed zones. Applicable to UDE endpoints only.
- `justification_reason` (Set of String) Can not be empty if justification_required is true. Allowed key access justification reasons. Options: REASON_UNSPECIFIED, CUSTOMER_INITIATED_SUPPORT, GOOGLE_INITIATED_SERVICE, THIRD_PARTY_DATA_REQUEST, GOOGLE_INITIATED_REVIEW, CUSTOMER_INITIATED_ACCESS, GOOGLE_INITIATED_SYSTEM_OPERATION, REASON_NOT_EXPECTED, MODIFIED_CUSTOMER_INITIATED_ACCESS and GOOGLE_RESPONSE_TO_PRODUCTION_ALERT.
- `justification_required` (Boolean) Set to true if key access justification should be enforced. Default is false.


